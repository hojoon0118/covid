---
title: "My Project"
author: "hi"
output:
  html_document:
    df_print: paged
---

```{r install-packages, eval=FALSE}
#install.packages(c("skimr", "visdat", "summarytools", "DT"))
#install.packages("devtools")
#devtools::install_github("daattali/ggExtra")
#install.packages("report")
```




# Part 1

The goals of Part 1 of your project are to:

* Identify your question and explain why you are asking it
* Identify, briefly describe, and read in your dataset to R
* Identify and describe the variables you will use to test your hypothesis.
* Identify how you will need to clean/wrangle your dataset.
* Identify limitations of your project as a whole. 

## Environment set up 

__q1__ Set up your environment by loading the needed packages and saving the file path(s) to your data as values in your environment.

```{r warning=FALSE, message=FALSE}
#Libaries
library("knitr")
library("tidyverse")
library("DT")
library("ggplot2")
library("ggExtra")
library("patchwork")# for making figure panels
#library("report")
```

## Project question

__q2__ What question will you answer in your project? 

I am going to find the which relationship does this data set have with each variable and find the meaningful relationship.

__q3__ Motivation: Why is this question interesting and/or important to ask? Ground your explanation in fact. Provide at least one example of how answering this question may be useful in the "real" world.

This question is interesting because COVID-19 has impacted many industries in our fields. Among all, the most issue is about economic effects. It is important because most country's economy is impacted by COVID in bad ways. It would be helpful to find the relationship between variable and GDP of a country relating to each countries economic situation and HDI(human development index). For example, by finding this relationship, people would be able to estimate or see how each country's economy situation will change in future.

__q4__ Phrase your question in terms of a testable hypothesis. 
Is there a relationship between total deaths of COVID-19, GDP, and HDI?/ What is the relationship between economic effect of COVID-19 referring each country's feature and situation./Does the Total cases or total death decreases if the GDP of HDI increases?


## The dataset

__q5__ What is the dataset will you use for your project? Provide a brief description of this dataset (e.g., who collected it and when, what data does it contain, why was it collected, how were the data collected). 
I am using a dataset of COVID-19. __collected, 2021, this data contains country, date, HDI, Total Death, Total Cases, Sexually Transmitted Infection, Population, GDP CAP.


__q6__ Save your dataset from the R package to your environment.

```{r}
# Example
# bach_data <- bachelorette
df.covid <- read.csv(file = 'data/transformed_data.csv', fileEncoding="UTF-8-BOM")
```

__q8__  Use the glimpse() function take a look at your dataset. How many observations are in your dataset and how many variables? 
```{r, eval=FALSE, echo=FALSE}
glimpse(df.covid)%>% head(10)
df.covid %>% 
  distinct(COUNTRY) %>% head(10)
df.covid %>%
  count(COUNTRY) %>% head(10)
df.covid %>%
  count(COUNTRY,DATE) %>% head(10)
df.covid %>%
  DT::datatable() 
```

```{r}
df.covid %>%
  visdat::vis_dat()
```


__q9__ Which variables will use to to examine your question? Describe what they are. Include what types of variables they are (e.g., character, integer, etc.) and what their scales of measurement are. 
country(POP), HDI+GDPCAP, TC, TD: Country is which country it is and POP is population, how many populations are in the country. HDI/GDPCAP is to measure how economic a country is how they live. TC&TD is total cases and total death meaning how many people got COVID-19 and died from COVID-19 

## Data challenges

__q10__ What will you do to clean and wrangle your dataset to make it appropriate for analysis? For example, will you remove certain columns or rows? Do you need to rename or recode variables? Do you need to create new variables? 

I will remove the code variable because I already have the name of the country for the code name variable. It is not useful. For the second I am goijng to remove the date variable becuase I will not use date variable and it will not affect the result of the research.

## Project limitations

__q11__ Describe at least two limitations of your data that may make it challenging to draw particular conclusions or interpret your findings (e.g., consider who is in the sample and the design of the study)?

____________________________________________________________________________________________

# Part 2

The goals of Part 2 of your project are to:

* Clean and wrangle your data and describe this process. 
* Visualize and summarize each of your variables and interpret what you see.  


# Data cleaning and wrangling

__q12__ In Part 1, you described the necessary data cleaning and wrangling you would need to do to make your data appropriate for analysis (__q10__). Perform this data cleaning below, as well as any additional cleaning/wrangling you need to do. For each data cleaning step, insert a separate chunk of code. For each step, explain why you are doing it in the whitespace below the chunk

```{r}
df.covid <- df.covid[ ,-1]
```
I erased CODE column in the data df.covid since it is redundant information with variable COUNTRY and I will not use this variable.

normalized total case(TC) and total death(TD) according to population(POP)
```{r}
df.covid <- df.covid %>% mutate(TCPOP = TC/POP, 
                    TDPOP = TD/POP)
```

REMOVED DATA POINTS THAT ARE BELOW ZERO BECAUSE WE EXPECT TO HAVE POSITIVE NUMBERS FOR GROSS DOMESTIC PRODUCT PER CAPITA (GDPCAP), SEXUALLY TRANSMITTED INDEX(STI), HUMAN DEVELOPMENT INDEX (HDI), POPULATION(POP).
```{r}
df.covid <- df.covid %>% filter(GDPCAP>0, STI>0, HDI>0, POP>0, TC>=0, TD>=0)
```

filtered the data only to have last date because total case and total death are accumulative.
```{r}
df.lastdate <- df.covid %>%
  group_by(COUNTRY) %>% 
  slice(which.max(as.Date(DATE)))
df.lastdate$GDPCAP%>%min()
```



```{r}
df.lastdate %>% head(10)
```


# Data visualization and summary 

__q13__ Use `ggplot()` to create histograms (`geom_histogram` or `geom_col`) showing the distributions of each of the variables you are using to test your hypothesis. Only plot one variable per chunk of code. At the end, describe the distribution of each variable in terms of whether it is normal, skewed, bimodal, etc. 


```{r}
p1 <- df.lastdate %>%
  ggplot( aes(x=POP)) +
    geom_histogram( binwidth=0.5, fill="#42e0f5", color="#e9ecef", alpha=0.9)

p2 <- df.lastdate %>%
  ggplot( aes(x=HDI)) +
    geom_histogram( binwidth=0.1, fill="#42e0f5", color="#e9ecef", alpha=0.9)

p3 <- df.lastdate %>%
  ggplot( aes(x=TC)) +
    geom_histogram( binwidth=0.5, fill="#42e0f5", color="#e9ecef", alpha=0.9)

p4 <- df.lastdate %>%
  ggplot( aes(x=TD)) +
    geom_histogram( binwidth=0.5, fill="#42e0f5", color="#e9ecef", alpha=0.9)

p5 <- df.lastdate %>%
  ggplot( aes(x=STI)) +
    geom_histogram( binwidth=0.1, fill="#42e0f5", color="#e9ecef", alpha=0.9)

p6 <- df.lastdate %>%
  ggplot( aes(x=GDPCAP)) +
    geom_histogram( binwidth=0.3, fill="#42e0f5", color="#e9ecef", alpha=0.9) 
    # ggtitle("GDPCAP histogram") 
    # theme(
    #   plot.title = element_text(size=20), panel.background = element_blank(), axis.line = element_line(colour = "grey")
    # )

p1 + p2 +p3 + p4 + p5 + p6 
  plot_layout(ncol=1) &
  theme_classic() & 
  theme(
      plot.title = element_text(size=20), panel.background = element_blank(), axis.line = element_line(colour = "grey")
     ) 
```

```{r}
fit = lm(TDPOP ~ GDPCAP+TCPOP+HDI+POP, data = df.lastdate)
HGa <- aov(fit) %>% summary()

HGa

fit = lm(TDPOP ~ GDPCAP+HDI+POP, data = df.lastdate)
HGB <- aov(fit) %>% summary()

HGB

fit = lm(TCPOP ~ GDPCAP+HDI+POP, data = df.lastdate)
HGC <- aov(fit) %>% summary()

fit

HGC
```
A multiple linear regression was calculated to predict TC based on GDPCAP, HDI, and POP. A significant regression equation was found (F(3, 157) = `r HGC$f.value`, `r HGC$p.value`). Participants' predicted TC is equal to 0.01985 * GDPCAP + 0.23022 * HDI + 0.02431 * POP - 0.13525.  
GDPCAP(f= 36.217, p < 0.001) and POP(f = 20.339, p < 0.001) were significant predictors of TC. While HDI(f = 2.234, p=0.137) was not significant predictors of TC.  
Therefore, I further analyzed each predictors of its relations to the TC.  

```{r}
#head(df.covid)

# classic plot :
p1 <- ggplot(df.lastdate, aes(x=GDPCAP, y=HDI, color = "#42e0f5", size=1)) +
      geom_point(alpha = 1, size = 1) +
      geom_smooth(method = "lm", se = T, color = "blue", fill="black", size = 1) +
  theme_classic()+
      theme(legend.position ="none")
  
 



# classic plot :
p2 <- ggplot(df.lastdate, aes(x=TC, y=TD, color = "#42e0f5", size=1)) +
      geom_point(alpha = 1, size = 1) +
      geom_smooth(method = "lm", se = T, color = "blue", fill="black", size = 1) +
  theme_classic()+
      theme(legend.position ="none")



p3 <- ggplot(df.lastdate, aes(x=GDPCAP, y=TCPOP, color = "#42e0f5")) +
      geom_point(alpha = 1, size = 1) +
      geom_smooth(method = "lm", se = T, color = "blue", fill="black", size = 1) +
  theme_classic()+
      theme(legend.position = "none")

p4 <- ggplot(df.lastdate, aes(x=GDPCAP, y=TDPOP, color = "#42e0f5")) +
      geom_point(alpha = 1, size = 1) +
      geom_smooth(method = "lm", se = T, color = "blue", fill="black", size = 1) +
  theme_classic()+
      theme(legend.position = "none")


p1 + p2 + p3 +p4
  plot_layout(ncol=1) &
  theme(
      plot.title = element_text(size=20), panel.background = element_blank(), axis.line = element_line(colour = "grey")
     ) 
```


```{r}
c1 <- cor.test(df.lastdate$GDPCAP,df.lastdate$HDI)

c2 <- cor.test(df.lastdate$TC, df.lastdate$TD)

c3 <- cor.test(df.lastdate$GDPCAP,df.lastdate$TCPOP)

```

All 3 have significant relationship between each variables and all of it has positive slope which means that it has positive relationship.
Pearson's correlation test revealed that GDPCAP and HDI has a strong positive relationship  p = `r c1$p.value %>% round(3)` r(`r c1$parameter`) = `r c1$estimate %>% round(3)` and similar positive relationship was found for TC and TD  p = `r c2$p.value %>% round(3)` r(`r c2$parameter`) = `r c2$estimate %>% round(3)` and lastly TCPOP and GDPCAP also showed positive relationship  p = `r c3$p.value %>% round(3)` r(`r c3$parameter`) = `r c3$estimate %>% round(3)` 
As expected GDPCAP and HDI had strong positive relationship because HDI is measurement for Human development which is known to be a measure that is indicative of a country's wealth.
More total cases leads to more total death due to covid as seen in above graph.

Interesting result shown in the graph of relationship between TCPOP and GDPCAP is it has positive relationship between these two. I expected that as country has more wealth and have better healthcare system, people will get less exposure to covid. However the result is shown in opposite way which means that people get more exposed to covid as country has better social infrastructure.

Beyond that I thought that better infrastructure would prevent people from dying even if they are infected by their covid but the result did not come out as I expected. Maybe this is due to the fact that there is no active way of treating covid yet.  



```{r}
fit = lm(HDI ~ 1 + GDPCAP, data = df.lastdate)
HGsum <- aov(fit) %>% summary()

fit = lm(TC ~ 1 + TD, data = df.lastdate)

CDsum <- aov(fit)%>%summary()

fit = lm(TCPOP ~ 1 + GDPCAP, data = df.lastdate)

CGsum <- aov(fit)%>%summary()

HGsum

CDsum

CGsum
```

Individual predictors relationship were analyzed using linear models. HDI and GDP(F(1, 159) = 1705, p < 0.001) showed significant linear relationship, which confirms previous correlation result.
TC and TD(F(1, 159) = 1189, p < 0.001) showed significant linear relationship as expected and it matches with the previous result.

TC and GDPCAP(F(1, 159) = 1705, p < 0.001) surprisingly showed significant linear relationship contrary to what was expected since many will think higher GDPCAP countries would have advanced healthcare system which would lead to lower cases of covid.  



```{r}
test1<-cor.test(df.covid$TC,df.covid$TD)
test2<-cor.test(df.covid$GDPCAP,df.covid$HDI)
```

```{r}
test1
```

```{r}
 df.covid <- df.covid%>%filter(TC>0, GDPCAP>0)
# classic plot :
p <- ggplot(df.covid, aes(x=GDPCAP, y=TC, color = "#42e0f5", size=1)) +
      geom_point() +
      theme(legend.position="none")
 
# Set relative size of marginal plots (main plot 10x bigger than marginals)
p1 <- ggMarginal(p, type="histogram", size=5)
p1

```

```{r}

```


RELATION BETWEEN GDPCAP AND TC

```{r}
df.covid1 <- df.covid%>% filter(GDPCAP>0)
p <- ggplot(df.covid1, aes(x=GDPCAP, y=TC, color = "#42e0f5", size=1)) +
      geom_point() +
      theme(legend.position="none")
p
```

```{r}
p <- ggMarginal(p, type="histogram", size=5)
p
```

```{r}
cor.test(df.covid$TC, df.covid$GDPCAP)
```

```{r}
fit = lm(TC ~ 1 + GDPCAP, data = df.covid1)

fit%>%summary()
```



RELATION BETWEEN GDPCAP AND TC

```{r}

```




RELATION BETWEEN POP AND GDPCAP

```{r}
df.covidgdp <- df.covid %>% filter(GDPCAP>0)

fit = lm(TC ~ 1 + GDPCAP, data = df.covidgdp)

fit%>%summary()

p <- ggplot(df.covidgdp, aes(x=POP, y=GDPCAP, color = "#42e0f5")) +
      geom_point(alpha = 0.3, size = 0.1) +
      geom_smooth(method = "lm", se = T, color = "blue", fill="black", size = 1) +
  theme_bw()
p
```


RELATION BETWEEN GDPCAP AND TD

```{r}
df.covidgf <- df.covid %>% filter(GDPCAP>0)

fit = lm(TD ~ 1 + GDPCAP, data = df.covidgf)

fit%>%summary()

p <- ggplot(df.covidgf, aes(x=GDPCAP, y=TD, color = "#42e0f5")) +
      geom_point(alpha = 0.3, size = 0.1) +
      geom_smooth(method = "lm", se = T, color = "blue", fill="black", size = 1) +
      theme_bw()
p
```



RELATION BETWEEN POP AND TC

```{r}
p <- ggplot(df.covid, aes(x=POP, y=TC, color = "#42e0f5", size=1)) +
      geom_point() +
      theme(legend.position="none")
 
# Set relative size of marginal plots (main plot 10x bigger than marginals)
p1 <- ggMarginal(p, type="histogram", size=5)
 
# Custom marginal plots:
#p2 <- ggMarginal(p, type="histogram", fill = "slateblue", xparams = list(  bins=10))
 
# Show only marginal plot for x axis
#p3 <- ggMarginal(p, margins = 'x', color="purple", size=4)

p1
```

```{r}

```

```{r}
fit = lm(TC ~ 1 + POP, data = df.covid)

fit%>%summary()
```


RELATION BETWEEN STI AND TC

```{r}
df.covidsf <- df.covid%>% filter(STI>0)
```


```{r}
p <- ggplot(df.covidsf, aes(x=STI, y=TC, color = "#42e0f5", size=1)) +
      geom_point() +
      theme(legend.position="none")
 
# Set relative size of marginal plots (main plot 10x bigger than marginals)
p1 <- ggMarginal(p, type="histogram", size=5)
 
# Custom marginal plots:
#p2 <- ggMarginal(p, type="histogram", fill = "slateblue", xparams = list(  bins=10))
 
# Show only marginal plot for x axis
#p3 <- ggMarginal(p, margins = 'x', color="purple", size=4)

p1
```

```{r}
cor.test(df.covid$STI, df.covid$TC)
```

```{r}
fit = lm(TC ~ 1 + STI, data = df.covid)

fit%>%summary()
```

```{r}
fit = lm(TC ~ 1 +STI, data = df.covidsf)

fit%>%summary()

p <- ggplot(df.covid, aes(x=STI, y=TC, color = "#42e0f5")) +
      geom_point(alpha = 0.3, size = 0.1) +
      geom_smooth(method = "lm", se = T, color = "blue", fill="black", size = 1) +
  theme_bw()
p
```


RELATION BETWEEN STI AND GDPCAP
```{r}
df.covidsgf <- df.covid%>% filter(GDPCAP>0)
```


```{r}
p <- ggplot(df.covidsgf, aes(x=STI, y=GDPCAP, color = "#42e0f5", size=1)) +
      geom_point() +
      theme(legend.position="none")
 
# Set relative size of marginal plots (main plot 10x bigger than marginals)
p1 <- ggMarginal(p, type="histogram", size=5)
 
# Custom marginal plots:
#p2 <- ggMarginal(p, type="histogram", fill = "slateblue", xparams = list(  bins=10))
 
# Show only marginal plot for x axis
#p3 <- ggMarginal(p, margins = 'x', color="purple", size=4)

p1
```

```{r}
cor.test(df.covid$STI, df.covid$GDPCAP)
```

```{r}
fit = lm(TC ~ 1 + STI, data = df.covid)

fit%>%summary()
```

```{r}
fit = lm(TC ~ 1 + STI, data = df.covidsgf)

fit%>%summary()

p <- ggplot(df.covidsgf, aes(x=STI, y=TC, color = "#42e0f5")) +
      geom_point(alpha = 0.3, size = 0.1) +
      geom_smooth(method = "lm", se = T, color = "blue", fill="black", size = 1) +
  theme_bw()
p
```



```{r}
fit = lm(TC ~ 1 + GDPCAP, data = df.covidsgf)

fit%>%summary()

p <- ggplot(df.covidsgf, aes(x=STI, y=GDPCAP, color = "#42e0f5")) +
      geom_point(alpha = 0.3, size = 0.1) +
      geom_smooth(method = "lm", se = T, color = "blue", fill="black", size = 1) +
  theme_bw()
p
```

```{r}
df.covidstf <- df.covid%>% filter(STI>0)
```


```{r}
p <- ggplot(df.covidstf, aes(x=STI, y=TD, color = "#42e0f5", size=1)) +
      geom_point() +
      theme(legend.position="none")
 
# Set relative size of marginal plots (main plot 10x bigger than marginals)
p1 <- ggMarginal(p, type="histogram", size=5)
 
# Custom marginal plots:
#p2 <- ggMarginal(p, type="histogram", fill = "slateblue", xparams = list(  bins=10))
 
# Show only marginal plot for x axis
#p3 <- ggMarginal(p, margins = 'x', color="purple", size=4)

p1
```

```{r}
cor.test(df.covid$STI, df.covid$TD)
```

```{r}
fit = lm(TC ~ 1 + GDPCAP, data = df.covidsgf)

fit%>%summary()

p <- ggplot(df.covidsgf, aes(x=STI, y=TD, color = "#42e0f5")) +
      geom_point(alpha = 0.3, size = 0.1) +
      geom_smooth(method = "lm", se = T, color = "blue", fill="black", size = 1) +
  theme_bw()
p
```


```{r}
fit = lm(TC/POP ~ 1 + GDPCAP+HDI+STI, data = df.lastdate)

fit%>%summary()
```










__q14__ Summarize each of the numeric variables you will use to test your hypothesis with the central tendency and standard deviation. For categorical/character variables, summarize with the frequency in each category 

```{r}

```

```{r}

```


____________________________________________________________________________________________



# Part 3

The goals of Part 3 of your project are to:

* Test your hypothesis using the appropriate statistical tests. 
*	Estimate how large the effect is by using one of the following: effect size, confidence intervals, Bayes factors
*	Visualize your results, including one figure that summarizes your primary result. 
*	Interpret your results in writing.


## Hypothesis testing

In Milestone 1, you identified your hypothesis for your project question. Please restate your hypothesis below (it's okay if it changed _prior_ to hypothesis testing):




__q15__ What is the null hypothesis?

_Black and White individuals are equally likely to be searched when stopped by the police. In other words, race and being searched are independent of each other_



__q16__ Test your hypothesis using the appropriate statistical tests. Points to consider: Are your variables continuous or categorical? If your variables are continuous, are they normally distributed? If one or more of your variables is categorical, how many categories are there?

```{r}

```

__q17__ In writing, interpret the results of your hypothesis test(s). Move beyond the p-value and where the test is "significant". For example, if you compared means, describe the size of the means in relation to each other; if you use a chi-square test, create a contingency table and describe the relative proportions; if you used regression, interpret the meaning of the intercept and slope(s). Overall, demonstrate that you understand what the test is estimating. 

_Example_: _Using a chi-square test, we tested the hypothesis that Black individuals are more likely to be searched when stopped by the police than are white individuals. Specifically, the chi-square test compared the observed proportions of Black and White individuals who were and were not searched to the proportions expected under the null hypothesis that race and being searched are independent. Results of the chi-square test indicated that the data were unlikely under the null hypothesis, X2(df = 1) = 828.3, p < .001. Specifically, White individuals were searched less than expected under the null hypothesis whereas Black individuals were searched more often than expected under the null hypothesis.Therefore, we can reject the null hypothesis that Black and White individuals are equally likely to be searched when stopped by the police._ 

# Effect size 

__q18__ Estimate how large the effect(s) are. Regardless of whether your hypothesis test was "significant", quantify the size of the effect using measure of effect sizes (e.g., odds ratio or standardized residual for chi-square test; strength of the correlation coefficient; standardized mean difference [cohen's d] for comparing means; standardized beta and/or R-squared for linear regression), confidence intervals, and/or Bayes factors. Interpret the the effect size in writing. 

```{r}

```

_Example_: _We computed the odds-ratio for the probability of Black individuals being searched by the police versus the probability of White individuals being searched by the police. Black individuals were 2.59 times more likely to be searched by the police than were White individuals._

__q19__ 

Use `ggplot()` to visualize your results. Include at least one plot that graphically depicts the primary result of your hypothesis test. Show the variability in the data: if you have a categorical variable, use a boxplot or violin plot; if you have continuous variables, show both the scatter plot (geom_point) and the appropriate trendline. 

Make your primary plot "presentation quality": 1) Provide a title that describes the main take-away of the plot (i.e., Black individuals are disproportionately searched by the police _NOT_ Proportions of Black and White individual searched by the police), 2) Label your axes, 3) Adjust the axis text if necessary by changing the "breaks" using one of the scale_ functions (e.g., scale_x_continuous, scale_x_discrete), 4) if one of your variables is categorical, order the data logically using fct_reorder(), 5) Consider adding reference lines using geom_vline or geom_hline. 

```{r}

```





